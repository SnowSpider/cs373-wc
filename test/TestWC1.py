#!/usr/bin/env python

import unittest
import wsgiref.handlers
import xml.etree.cElementTree as ET
from google.appengine.ext import webapp
import logging
from google.appengine.ext import db
from google.appengine.ext.db import polymodel
from google.appengine.ext import testbed
import django.utils.simplejson

"""
To test the program:
    % python TestWC1.py > TestWC1.out
    % python TestWC1.py &> TestWC1.out
    % chmod ugo+x TestWC1.py
    % TestWC1.py > TestWC1.out
"""

# -------
# imports
# -------

import StringIO
import unittest
import logging


from WC1 import ImportXml, ExportXml, fixAmp, debug

# -------
# TestPFD
# -------

class TestWC1 (unittest.TestCase) :
    """
    def test_ImportXml_1 (self) :
        imported = ImportXml("test1.xml")
        self.assert_(imported != {})
        self.assert_(imported == {"crises":{}, "orgs":{}, "people":{}})
        #self.assert_(True)
        
    def test_ImportXml_2 (self) :
        a = ImportXml("test1.xml")
        b = ImportXml("test1.xml")
        self.assert_(a == b)
        #self.assert_(not any(map(lambda x: True, (k for k in b if k not in a)))) #compares 2 dictionaries by content
    
    def test_ImportXml_3 (self) :
        imported = ImportXml("test2.xml")
        self.assert_(imported["people"]["Sogol"].name == "Sogol")
        self.assert_(imported["crises"]["Migraine"].name == "Migraine")
        self.assert_(imported["orgs"]["UT"].name == "UT")
    """
    def test_ImportXml_4 (self) :
        imported = ImportXml("WC.xml")
        self.assert_(imported["people"]["Mir Hossein Mousavi"].name == "Mir Hossein Mousavi")
        self.assert_(imported["people"]["Mir Hossein Mousavi"].kind_ == "Presidential Candidate of 2009 Iran's Elections")
        self.assert_(imported["people"]["Mir Hossein Mousavi"].location == "Tehran, Iran")
        self.assert_(imported["people"]["Mir Hossein Mousavi"].history == "In 2009 Iranian Presidential election, Mousavi came out of semi-retirement and ran as one of two Reformist candidates against the Administration of incumbent President Mahmoud Ahmadinejad. However he failed to win the election, and following alleged vote rigging and manipulation, his campaign sparked a long protest that eventually turned into a national movement against the Government and Supreme Leader Ali Khamenei. Despite the violent crackdown, he remains the leader of the Green Movement but his movements have remained severely restricted. He chose green as his campaign color, a color which has since become pervasive in Iran. He is currently under house arrest along with his wife and Mehdi Karroubi.")
        self.assert_(imported["people"]["Mir Hossein Mousavi"].images[0] == db.Link("http://upload.wikimedia.org/wikipedia/commons/5/59/Mir_Hossein_Mousavi_in_Zanjan_by_Mardetanha.jpg"))
        self.assert_(imported["people"]["Mir Hossein Mousavi"].images[1] == db.Link("http://newsimg.bbc.co.uk/media/images/45805000/jpg/_45805312_007298103-1.jpg"))
        self.assert_(imported["people"]["Mir Hossein Mousavi"].videos[0] == db.Link("http://www.youtube.com/watch?v=a0yxKpX0iac&feature=related"))
        self.assert_(imported["people"]["Mir Hossein Mousavi"].social_networks[0] == db.Link("http://www.facebook.com/mousavi"))
        self.assert_(imported["people"]["Mir Hossein Mousavi"].external_links[0] == db.Link("http://news.bbc.co.uk/2/hi/middle_east/8103851.stm"))
        self.assert_(imported["people"]["Mir Hossein Mousavi"].related_crises[0] == "Iranian_Green_Movement")
        self.assert_(imported["people"]["Mir Hossein Mousavi"].related_orgs[0] == "International_Campaign_for_Human_Rights_in_Iran")
    
    def test_ImportXml_5 (self) :
        imported = ImportXml("WC.xml")
        self.assert_(imported["crises"]["Iranian Green Movement"].name == "Iranian Green Movement")
        self.assert_(imported["crises"]["Iranian Green Movement"].kind_ == "Uprising")
        self.assert_(imported["crises"]["Iranian Green Movement"].location == "Iran")
        self.assert_(imported["crises"]["Iranian Green Movement"].date_and_time == "May 2009")
        self.assert_(imported["crises"]["Iranian Green Movement"].human_impact == "In the aftermath of the election, protests were widened and several massive protests were held around the country by the people. The government arrested a large number of the protesters and several were killed by the police and governmental militia forces. Handala, coming and watching the Iranian Green Movement, has become a web mascot. Although the Iranian government prohibited any form of gathering by opposition-supporters in Tehran and across the country, significantly slowed down internet access and censored any form of media agreeing with the opposition, hundreds of thousands of Iranians chanted this motto, defying the law and challenging the Islamic Republic.")
        self.assert_(imported["crises"]["Iranian Green Movement"].economic_impact == None)
        self.assert_(imported["crises"]["Iranian Green Movement"].resources_needed == "World Support")
        self.assert_(imported["crises"]["Iranian Green Movement"].ways_to_help == "Oppose a Military Strike on Iran, Call for the Release of Opposition Leaders Under House Arrest, Call for the release of imprisoned human rights lawyer Nasrin Sotoudeh!")
        self.assert_(imported["crises"]["Iranian Green Movement"].history == "Protests following the 2009 Iranian presidential election against the disputed victory of Iranian President Mahmoud Ahmadinejad and in support of opposition candidates Mir-Hossein Mousavi and Mehdi Karroubi occurred in major cities in Iran and around the world starting 13 June 2009. The protests were given several titles by their proponents including Green Revolution, Green Wave or Sea of Green, reflecting presidential candidate Mousavi\'s campaign color, and also Persian Awakening. The creation of the Iranian Green Movement was developed during these protests. The events have also been nicknamed the \"Twitter Revolution\" because of the protesters\' reliance on Twitter and other social-networking Internet sites to communicate with each other. Islamic politician Ata\'ollah Mohajerani blasted the election as \"the end of the Islamic Republic\". In response to the protests, other groups rallied in Tehran to support Ahmadinejad.\nWidespread editorial analyses assert that the 2009 election marks the official end of the Islamic Republic and the beginning of the Islamic emirate or an imamate regime. All three opposition candidates claimed that the votes were manipulated and the election was rigged, and candidates Mohsen Rezaee and Mousavi have lodged official complaints. Mousavi announced that he \"won\'t surrender to this manipulation\" before lodging an official appeal against the result to the Guardian Council on 14 June. Ayatollah Ali Khamenei declared the unprecedented voter turnout and coinciding religious holidays as a \"divine assessment\" and urged the nation to unite, but later ostensibly ordered an investigation into the claims of voting fraud and irregularities as per the request of the Green movement leaders. Mousavi is not optimistic about his appeal, saying that many of the group\'s members \"during the election were not impartial\". Ahmadinejad called the election \"completely free\" and the outcome \"a great victory\" for Iran, dismissing the protests as little more than \"passions after a soccer match\".\nPolice and the Basij (a paramilitary group) suppressed both peaceful demonstrating and rioting by using batons, pepper spray, sticks and, in some cases, firearms. The Iranian government has confirmed the deaths of 36 people during the protests, while unconfirmed reports by supporters of Mousavi allege that there have been 72 deaths (twice as many) in the three months following the disputed election. Iranian authorities have closed universities in Tehran, blocked web sites, blocked cell phone transmissions and text messaging, and banned rallies.")
        self.assert_(imported["crises"]["Iranian Green Movement"].images[0] == db.Link("http://upload.wikimedia.org/wikipedia/commons/thumb/6/66/6th_Day_-_Mousavi_inside_the_Crowd.jpg/800px-6th_Day_-_Mousavi_inside_the_Crowd.jpg"))
        self.assert_(imported["crises"]["Iranian Green Movement"].videos[0] == db.Link("http://www.youtube.com/watch?v=quPXg_GoTOk&feature=related"))
        self.assert_(imported["crises"]["Iranian Green Movement"].social_networks[0] == db.Link("http://www.facebook.com/Persian.Green.Movement"))
        self.assert_(imported["crises"]["Iranian Green Movement"].external_links[0] == db.Link("http://en.irangreenvoice.com"))
        self.assert_(imported["crises"]["Iranian Green Movement"].related_orgs[0] == "International_Campaign_for_Human_Rights_in_Iran")
        self.assert_(imported["crises"]["Iranian Green Movement"].related_people[0] == "Mir_Hossein_Mousavi")
        
    def test_ImportXml_6 (self) :
        imported = ImportXml("WC.xml")
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].name == "International Campaign for Human Rights in Iran")
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].kind_ == "Campaign")
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].location == "Netherlands")
        
        #self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].history == "")
        # Non-ASCII character '\xe2' in file
        
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].contact_info.email == db.Email("info@iranhumanrights.org"))
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].contact_info.phone_number == db.PhoneNumber("0000000"))
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].contact_info.address == db.PostalAddress("Netherlands"))
        
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].images[0] == db.Link("http://www.iranhumanrights.org/wp-content/uploads/Ronaghi21-300x2171.jpg"))
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].videos[0] == db.Link("http://www.youtube.com/watch?v=B-Kmb1Hm0n0&feature=player_embedded"))
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].social_networks[0] == db.Link("http://www.facebook.com/pages/International-Campaign-for-Human-Rights-in-Iran/49929580840"))
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].external_links[0] == db.Link("http://www.iranhumanrights.org"))
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].related_crises[0] == "Iranian_Green_Movement")
        self.assert_(imported["orgs"]["International Campaign for Human Rights in Iran"].related_people[0] == "Mir_Hossein_Mousavi")
    """
    def test_ExportXml_1 (self) :
        data = ImportXml("test2.xml")
        result = ExportXml(data)
        self.assert_(result == "<everything>\n\t<people>\n\t\t<person>\n\t\t\t<name>Sogol</name>\n\t\t</person>\n\t</people>\n\t<crises>\n\t\t<crisis>\n\t\t\t<name>Migraine</name>\n\t\t</crisis>\n\t</crises>\n\t<orgs>\n\t\t<org>\n\t\t\t<name>UT</name>\n\t\t</org>\n\t</orgs>\n</everything>")
    
    def test_ExportXml_2 (self) :
        data = ImportXml("")
        result = ExportXml(data)
        self.assert_(result == "")
    
    def test_ExportXml_3 (self) :
        data = ImportXml("")
        result = ExportXml(data)
        self.assert_(result == "")
    """
    
    def test_ExportXml_4 (self) :
        data = ImportXml("WC.xml")
        result = ExportXml(data)
        self.assert_(result == "<everything>\n\t<people>\n\t\t<person id = \"Mir_Hossein_Mousavi\">\n\t\t\t<name>Mir Hossein Mousavi</name>\n\t\t\t<kind>Presidential Candidate of 2009 Iran\'s Elections</kind>\n\t\t\t<location>Tehran, Iran</location>\n\t\t\t<history>In 2009 Iranian Presidential election, Mousavi came out of semi-retirement and ran as one of two Reformist candidates against the Administration of incumbent President Mahmoud Ahmadinejad. However he failed to win the election, and following alleged vote rigging and manipulation, his campaign sparked a long protest that eventually turned into a national movement against the Government and Supreme Leader Ali Khamenei. Despite the violent crackdown, he remains the leader of the Green Movement but his movements have remained severely restricted. He chose green as his campaign color, a color which has since become pervasive in Iran. He is currently under house arrest along with his wife and Mehdi Karroubi.</history>\n\t\t\t<images>\n\t\t\t\t<link>http://upload.wikimedia.org/wikipedia/commons/5/59/Mir_Hossein_Mousavi_in_Zanjan_by_Mardetanha.jpg</link>\n\t\t\t\t<link>http://newsimg.bbc.co.uk/media/images/45805000/jpg/_45805312_007298103-1.jpg</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://www.youtube.com/watch?v=a0yxKpX0iac&amp;feature=related</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>http://www.facebook.com/mousavi</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://news.bbc.co.uk/2/hi/middle_east/8103851.stm</link>\n\t\t\t</external_links>\n\t\t\t<related_crises>\n\t\t\t\t<crisisRef>Iranian_Green_Movement</crisisRef>\n\t\t\t</related_crises>\n\t\t\t<related_orgs>\n\t\t\t\t<orgRef>International_Campaign_for_Human_Rights_in_Iran</orgRef>\n\t\t\t</related_orgs>\n\t\t</person>\n\t\t<person id = \"Mustafa_Abdul_Jalil\">\n\t\t\t<name>Mustafa Abdul Jalil</name>\n\t\t\t<kind>Chairman of the National Transitional Council of Libya</kind>\n\t\t\t<location>Libya</location>\n\t\t\t<history></history>\n\t\t\t<images>\n\t\t\t\t<link>http://1.bp.blogspot.com/-tHBHlck16yA/TqK7Lqeh2TI/AAAAAAAACd0/7OSD4-lQukw/s1600/head+bump.jpg</link>\n\t\t\t\t<link>http://a.abcnews.go.com/images/International/42daef1774e44bd78ea83fd9878c269d.jpg</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://youtu.be/eNLc_OuPVxQ</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>http://www.facebook.com/pages/%D9%85%D8%B5%D8%B7%D9%81%D9%89-%D8%B9%D8%A8%D8%AF-%D8%A7%D9%84%D8%AC%D9%84%D9%8A%D9%84/134535143287038?rf=135221043216666</link>\n\t\t\t\t<link>http://twitter.com/#!/mustafaajalil</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://www.bbc.co.uk/news/world-africa-14613679</link>\n\t\t\t</external_links>\n\t\t\t<related_crises>\n\t\t\t\t<crisisRef>Libyan_Civil_War</crisisRef>\n\t\t\t</related_crises>\n\t\t\t<related_orgs></related_orgs>\n\t\t</person>\n\t\t<person id = \"Bashar_al-Assad\">\n\t\t\t<name>Bashar al-Assad</name>\n\t\t\t<kind>Current President of Syria</kind>\n\t\t\t<location>Damascus, Syria</location>\n\t\t\t<history></history>\n\t\t\t<images>\n\t\t\t\t<link>http://upload.wikimedia.org/wikipedia/commons/7/7d/Bashar_al-Assad_%28cropped%29.jpg</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://media.smh.com.au/selections/syria-cabinet-sworn-in-amid-violence-3407301.html</link>\n\t\t\t\t<link>http://www.guardian.co.uk/world/video/2012/jun/03/syria-assad-denies-responsibility-houla-massacre-video/</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>http://sana.sy/eng/article/5.htm</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://sana.sy/eng/article/5.htm</link>\n\t\t\t</external_links>\n\t\t\t<related_crises>\n\t\t\t\t<crisisRef>Syrian_Uprising</crisisRef>\n\t\t\t</related_crises>\n\t\t\t<related_orgs>\n\t\t\t\t<orgRef>Amnesty_International</orgRef>\n\t\t\t</related_orgs>\n\t\t</person>\n\t\t<person id = \"Rebiya_Kadeer\">\n\t\t\t<name>Rebiya Kadeer</name>\n\t\t\t<kind>human rights activist, president of WUC</kind>\n\t\t\t<location>Virginia, USA</location>\n\t\t\t<history></history>\n\t\t\t<images>\n\t\t\t\t<link>http://upload.wikimedia.org/wikipedia/commons/1/15/Rebiya_Kadeer_(2).jpg</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://www.youtube.com/watch?v=AXfxKFd67UI</link>\n\t\t\t\t<link>http://www.youtube.com/watch?v=Mohvi4Ov6wY</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>https://twitter.com/#!/rebiyakadeer</link>\n\t\t\t\t<link>https://twitter.com/#!/10ConditionLove</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://thesnowlionblog.blogspot.com/2009/04/rebiya-kadeer-human-rights-champion-for.html</link>\n\t\t\t\t<link>http://www.csmonitor.com/World/Asia-Pacific/2009/0709/p06s15-woap.html</link>\n\t\t\t\t<link>http://news.bbc.co.uk/2/hi/asia-pacific/4357607.stm</link>\n\t\t\t</external_links>\n\t\t\t<related_crises>\n\t\t\t\t<crisisRef>Xinjiang_Riots</crisisRef>\n\t\t\t</related_crises>\n\t\t\t<related_orgs>\n\t\t\t\t<orgRef>World_Uyghur_Congress</orgRef>\n\t\t\t</related_orgs>\n\t\t</person>\n\t</people>\n\t<crises>\n\t\t<crisis id = \"Iranian_Green_Movement\">\n\t\t\t<name>Iranian Green Movement</name>\n\t\t\t<kind>Uprising</kind>\n\t\t\t<location>Iran</location>\n\t\t\t<date_and_time>May 2009</date_and_time>\n\t\t\t<human_impact>In the aftermath of the election, protests were widened and several massive protests were held around the country by the people. The government arrested a large number of the protesters and several were killed by the police and governmental militia forces. Handala, coming and watching the Iranian Green Movement, has become a web mascot. Although the Iranian government prohibited any form of gathering by opposition-supporters in Tehran and across the country, significantly slowed down internet access and censored any form of media agreeing with the opposition, hundreds of thousands of Iranians chanted this motto, defying the law and challenging the Islamic Republic.</human_impact>\n\t\t\t<economic_impact></economic_impact>\n\t\t\t<resources_needed>World Support</resources_needed>\n\t\t\t<ways_to_help>Oppose a Military Strike on Iran, Call for the Release of Opposition Leaders Under House Arrest, Call for the release of imprisoned human rights lawyer Nasrin Sotoudeh!</ways_to_help>\n\t\t\t<history>Protests following the 2009 Iranian presidential election against the disputed victory of Iranian President Mahmoud Ahmadinejad and in support of opposition candidates Mir-Hossein Mousavi and Mehdi Karroubi occurred in major cities in Iran and around the world starting 13 June 2009. The protests were given several titles by their proponents including Green Revolution, Green Wave or Sea of Green, reflecting presidential candidate Mousavi\'s campaign color, and also Persian Awakening. The creation of the Iranian Green Movement was developed during these protests. The events have also been nicknamed the \"Twitter Revolution\" because of the protesters\' reliance on Twitter and other social-networking Internet sites to communicate with each other. Islamic politician Ata\'ollah Mohajerani blasted the election as \"the end of the Islamic Republic\". In response to the protests, other groups rallied in Tehran to support Ahmadinejad.\nWidespread editorial analyses assert that the 2009 election marks the official end of the Islamic Republic and the beginning of the Islamic emirate or an imamate regime. All three opposition candidates claimed that the votes were manipulated and the election was rigged, and candidates Mohsen Rezaee and Mousavi have lodged official complaints. Mousavi announced that he \"won\'t surrender to this manipulation\" before lodging an official appeal against the result to the Guardian Council on 14 June. Ayatollah Ali Khamenei declared the unprecedented voter turnout and coinciding religious holidays as a \"divine assessment\" and urged the nation to unite, but later ostensibly ordered an investigation into the claims of voting fraud and irregularities as per the request of the Green movement leaders. Mousavi is not optimistic about his appeal, saying that many of the group\'s members \"during the election were not impartial\". Ahmadinejad called the election \"completely free\" and the outcome \"a great victory\" for Iran, dismissing the protests as little more than \"passions after a soccer match\".\nPolice and the Basij (a paramilitary group) suppressed both peaceful demonstrating and rioting by using batons, pepper spray, sticks and, in some cases, firearms. The Iranian government has confirmed the deaths of 36 people during the protests, while unconfirmed reports by supporters of Mousavi allege that there have been 72 deaths (twice as many) in the three months following the disputed election. Iranian authorities have closed universities in Tehran, blocked web sites, blocked cell phone transmissions and text messaging, and banned rallies.</history>\n\t\t\t<images>\n\t\t\t\t<link>http://upload.wikimedia.org/wikipedia/commons/thumb/6/66/6th_Day_-_Mousavi_inside_the_Crowd.jpg/800px-6th_Day_-_Mousavi_inside_the_Crowd.jpg</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://www.youtube.com/watch?v=quPXg_GoTOk&amp;feature=related</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>http://www.facebook.com/Persian.Green.Movement</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://en.irangreenvoice.com</link>\n\t\t\t</external_links>\n\t\t\t<related_orgs>\n\t\t\t\t<orgRef>International_Campaign_for_Human_Rights_in_Iran</orgRef>\n\t\t\t</related_orgs>\n\t\t\t<related_people>\n\t\t\t\t<personRef>Mir_Hossein_Mousavi</personRef>\n\t\t\t</related_people>\n\t\t</crisis>\n\t\t<crisis id = \"Libyan_Civil_War\">\n\t\t\t<name>Libyan Civil War</name>\n\t\t\t<kind>Civil War</kind>\n\t\t\t<location>Libya</location>\n\t\t\t<date_and_time>Feb 15 2011</date_and_time>\n\t\t\t<human_impact>Over 13,000 deaths, 50,000 refugees</human_impact>\n\t\t\t<economic_impact></economic_impact>\n\t\t\t<resources_needed>medicine, fuel, food</resources_needed>\n\t\t\t<ways_to_help></ways_to_help>\n\t\t\t<history></history>\n\t\t\t<images>\n\t\t\t\t<link>http://www.socialistparty.net/images/stories/libyan%20revolt.jpg</link>\n\t\t\t\t<link>http://fifp.files.wordpress.com/2011/04/2011_middle_east_revolutions_-_libyans_protesting_on_tank.jpg</link>\n\t\t\t\t<link>http://www.flixya.com/files-photo/r/i/m/rimawi-1965850.jpg</link>\n\t\t\t\t<link>http://nimg.sulekha.com/others/original700/libya-2011-2-26-12-20-0.jpg</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://youtu.be/8OzwkCGJlAI</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>http://www.facebook.com/Liibyan.Revolution</link>\n\t\t\t\t<link>http://www.facebook.com/Libyan4Life</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://www.ntc.gov.ly/</link>\n\t\t\t</external_links>\n\t\t\t<related_orgs>\n\t\t\t\t<orgRef>International_Criminal_Court</orgRef>\n\t\t\t</related_orgs>\n\t\t\t<related_people>\n\t\t\t\t<personRef>Mustafa_Abdul_Jalil</personRef>\n\t\t\t</related_people>\n\t\t</crisis>\n\t\t<crisis id = \"Syrian_Uprising\">\n\t\t\t<name>Syrian Uprising</name>\n\t\t\t<kind>violent internal conflict in Syria</kind>\n\t\t\t<location>Syria</location>\n\t\t\t<date_and_time>2011-present</date_and_time>\n\t\t\t<human_impact>10,537-10,770 killed overall (government claim)*, 15,200\-16,360 killed overall (opposition claims)*, 35,000 wounded overall, 240,000 displaced (180,000 refugees)</human_impact>\n\t\t\t<economic_impact>fuel shortages, currency problems &amp; sanctions</economic_impact>\n\t\t\t<resources_needed>recouses for refugees, human rights</resources_needed>\n\t\t\t<ways_to_help>http://www.wikihow.com/Help-the-Syrian-Revolution-from-Where-You-Are</ways_to_help>\n\t\t\t<history></history>\n\t\t\t<images>\n\t\t\t\t<link>http://www.google.com/imgres?hl=en&amp;sa=X&amp;biw=1680&amp;bih=941&amp;tbm=isch&amp;prmd=imvnsu&amp;tbnid=6No5lmE413pmDM:&amp;imgrefurl=http://www.supplychaindigital.com/global_logistics/syrian-uprising-deals-ocean-shipping-a-major-blow&amp;docid=JIY78reYqD8B0M&amp;imgurl=http://www.supplychaindigital.com/global_logistics/Syrian%252520Uprising%252520Protests.jpg&amp;w=610&amp;h=335&amp;ei=llvrT9baCMqW2QXm-52wAQ&amp;zoom=1&amp;iact=hc&amp;vpx=391&amp;vpy=165&amp;dur=163&amp;hovh=166&amp;hovw=303&amp;tx=156&amp;ty=87&amp;sig=105712859579245472816&amp;page=1&amp;tbnh=103&amp;tbnw=188&amp;start=0&amp;ndsp=35&amp;ved=1t:429,r:1,s:0,i:79</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://www.aljazeera.com/news/middleeast/2012/06/2012627132722216959.html</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>http://www.facebook.com/syrianuprising</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://www.focus-fen.net/index.php?id=n281597</link>\n\t\t\t</external_links>\n\t\t\t<related_orgs>\n\t\t\t\t<orgRef>Amnesty_International</orgRef>\n\t\t\t</related_orgs>\n\t\t\t<related_people>\n\t\t\t\t<personRef>Bashar_al-Assad</personRef>\n\t\t\t</related_people>\n\t\t</crisis>\n\t\t<crisis id = \"Xinjiang_Riots\">\n\t\t\t<name>Xinjiang Riots</name>\n\t\t\t<kind>anti-government/ethnic protest</kind>\n\t\t\t<location>Urumqi, Xinjiang Uyghur Autonomous Region, China</location>\n\t\t\t<date_and_time>5 July 2009</date_and_time>\n\t\t\t<human_impact>197 deaths, 1721 injured</human_impact>\n\t\t\t<economic_impact>Uyghur businesses destroyed by Chinese mob</economic_impact>\n\t\t\t<resources_needed></resources_needed>\n\t\t\t<ways_to_help></ways_to_help>\n\t\t\t<history></history>\n\t\t\t<images>\n\t\t\t\t<link>http://www.farwestchina.com/wp-content/uploads/2011/07/Urumqi-Riots.jpg</link>\n\t\t\t\t<link>http://english.people.com.cn/mediafile/200907/07/P200907072014041872629287.jpg</link>\n\t\t\t\t<link>http://english.people.com.cn/mediafile/200907/07/P200907072014352294282832.jpg</link>\n\t\t\t\t<link>http://english.people.com.cn/mediafile/200907/07/P200907072018061766028774.jpg</link>\n\t\t\t\t<link>http://english.people.com.cn/mediafile/200907/07/P200907072017392257014210.jpg</link>\n\t\t\t\t<link>http://english.people.com.cn/mediafile/200907/07/P200907072017145684313201.jpg</link>\n\t\t\t\t<link>http://english.people.com.cn/mediafile/200907/07/P200907072016482444221649.jpg</link>\n\t\t\t\t<link>http://english.people.com.cn/mediafile/200907/07/P200907072016212332964133.jpg</link>\n\t\t\t\t<link>http://english.people.com.cn/mediafile/200907/07/P200907072015483259527910.jpg</link>\n\t\t\t\t<link>http://english.people.com.cn/mediafile/200907/07/P200907072015165972213332.jpg</link>\n\t\t\t\t<link>http://english.people.com.cn/mediafile/200907/07/P200907072014551663971071.jpg</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://www.youtube.com/watch?v=DN3gUoWTnkY</link>\n\t\t\t\t<link>http://www.youtube.com/watch?v=8AzlgXQaJ3I</link>\n\t\t\t\t<link>http://www.youtube.com/watch?v=e3jkr7fsdsc</link>\n\t\t\t\t<link>http://www.youtube.com/watch?v=KwCHfBfF1m4</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>https://twitter.com/#!/UYGHURS</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://english.cntv.cn/english/special/0705riots/UrumqiRiots/index.shtml</link>\n\t\t\t\t<link>http://cnreviews.com/life/news-issues/urumqi-riots-western-chinese-narratives-truths_20090708.html</link>\n\t\t\t\t<link>http://forum.globaltimes.cn/forum/showthread.php?t=912</link>\n\t\t\t\t<link>http://www.telegraph.co.uk/news/worldnews/asia/china/5756766/China-riots-Twitter-and-YouTube-frustrate-censorship-attempts.html</link>\n\t\t\t</external_links>\n\t\t\t<related_orgs>\n\t\t\t\t<orgRef>World_Uyghur_Congress</orgRef>\n\t\t\t</related_orgs>\n\t\t\t<related_people>\n\t\t\t\t<personRef>Rebiya_Kadeer</personRef>\n\t\t\t</related_people>\n\t\t</crisis>\n\t</crises>\n\t<orgs>\n\t\t<org id = \"International_Campaign_for_Human_Rights_in_Iran\">\n\t\t\t<name>International Campaign for Human Rights in Iran</name>\n\t\t\t<kind>Campaign</kind>\n\t\t\t<location>Netherlands</location>\n\t\t\t<history>In late 2007, human rights activists working in the framework of the Dutch nongovernmental organization Foundation for Human Security in the Middle East resolved to found an international initiative focused on the urgent challenges faced by the Iranian people, and in particular civil society and the human rights community.The human rights community in Iran is in an exposed and dangerous position, subject to severe persecution and without effective support from the international community. International tensions provide a pretext for increasing repression within Iran, and remove human rights from the international agenda. The vibrant social movements in Iran—movements, inter alia, of women, students, and workers— work courageously in an un-free environment, subject to tremendous official pressures. They urgently need and welcome international concerns and solidarity, which must be strengthened through more effective support from international civil society and intergovernmental institutions.</history>\n\t\t\t<contact_info>\n\t\t\t\t<email>info@iranhumanrights.org</email>\n\t\t\t\t<phone_number>0000000</phone_number>\n\t\t\t\t<address>Netherlands</address>\n\t\t\t</contact_info>\n\t\t\t<images>\n\t\t\t\t<link>http://www.iranhumanrights.org/wp-content/uploads/Ronaghi21-300x2171.jpg</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://www.youtube.com/watch?v=B-Kmb1Hm0n0&amp;feature=player_embedded</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>http://www.facebook.com/pages/International-Campaign-for-Human-Rights-in-Iran/49929580840</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://www.iranhumanrights.org</link>\n\t\t\t</external_links>\n\t\t\t<related_crises>\n\t\t\t\t<crisisRef>Iranian_Green_Movement</crisisRef>\n\t\t\t</related_crises>\n\t\t\t<related_people>\n\t\t\t\t<personRef>Mir_Hossein_Mousavi</personRef>\n\t\t\t</related_people>\n\t\t</org>\n\t\t<org id = \"International_Criminal_Court\">\n\t\t\t<name>International Criminal Court</name>\n\t\t\t<kind>International Tribunal</kind>\n\t\t\t<location>Hague, Netherlands</location>\n\t\t\t<history>	 The International Criminal Court (ICC), governed by the Rome Statute, is the first permanent, treaty based, international criminal court established to help end impunity for the perpetrators of the most serious crimes of concern to the international community.\nThe ICC is an independent international organisation, and is not part of the United Nations system. Its seat is at The Hague in the Netherlands. Although the Court’s expenses are funded primarily by States Parties, it also receives voluntary contributions from governments, international organisations, individuals, corporations and other entities.\nThe international community has long aspired to the creation of a permanent international court, and, in the 20th century, it reached consensus on definitions of genocide, crimes against humanity and war crimes. The Nuremberg and Tokyo trials addressed war crimes, crimes against peace, and crimes against humanity committed during the Second World War. \n\nIn the 1990s after the end of the Cold War, tribunals like the International Criminal Tribunal for the former Yugoslavia and for Rwanda were the result of consensus that impunity is unacceptable. However, because they were established to try crimes committed only within a specific time-frame and during a specific conflict, there was general agreement that an independent, permanent criminal court was needed. \n\nOn 17 July 1998, the international community reached an historic milestone when 120 States adopted the Rome Statute, the legal basis for establishing the permanent International Criminal Court.\nThe Rome Statute entered into force on 1 July 2002 after ratification by 60 countries.</history>\n\t\t\t<contact_info>\n\t\t\t\t<email>visits@icc-cpi.int</email>\n\t\t\t\t<phone_number>+ 31 (0)70 515 8515</phone_number>\n\t\t\t\t<address>Po Box 19519\n\t\t   2500 CM, The Hague\n\t 	   The Netherlands</address>\n\t\t\t</contact_info>\n\t\t\t<images>\n\t\t\t\t<link>http://archive2.globalsolutions.org/files/general/icc.jpg</link>\n\t\t\t\t<link>http://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/International_Criminal_Court_logo.svg/673px-International_Criminal_Court_logo.svg.png</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://youtu.be/zfo7lMnR4O8</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>http://www.facebook.com/pages/International-Criminal-Court/106219979409522</link>\n\t\t\t\t<link>http://twitter.com/#!/IntlCrimCourt</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://www.icc-cpi.int/</link>\n\t\t\t</external_links>\n\t\t\t<related_crises>\n\t\t\t\t<crisisRef>Libyan_Civil_War</crisisRef>\n\t\t\t</related_crises>\n\t\t\t<related_people></related_people>\n\t\t</org>\n\t\t<org id = \"Amnesty_International\">\n\t\t\t<name>Amnesty International</name>\n\t\t\t<kind>non-governmental organisation focused on human rights</kind>\n\t\t\t<location>Global, General secretariat in London</location>\n\t\t\t<history>July 1961 by Peter Benenson in Britain</history>\n\t\t\t<contact_info>\n\t\t\t\t<email>Various department emails available at www.amnesty.org.</email>\n\t\t\t\t<phone_number>+44-20-74135500</phone_number>\n\t\t\t\t<address>The International Secretariat is responsible for the majority of the organization\'s research and leads our campaigning work, based in London, UK.\n1 Easton Street\nLondon\nWC1X 0DW, UK</address>\n\t\t\t</contact_info>\n\t\t\t<images>\n\t\t\t\t<link>http://www.codoc.org/wp-content/uploads/2012/04/amnesty.jpeg</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://www.youtube.com/user/AmnestyInternational</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>http://twitter.com/#!/amnesty</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://www.amnesty.org</link>\n\t\t\t\t<link>http://www.amnesty.org/en/news/iran-must-avoid-excessive-force-against-green-movement-protests-2012-02-13</link>\n\t\t\t</external_links>\n\t\t\t<related_crises>\n\t\t\t\t<crisisRef>Syrian_Uprising</crisisRef>\n\t\t\t\t<crisisRef>Xinjiang_Riots</crisisRef>\n\t\t\t\t<crisisRef>Libyan_Civil_War</crisisRef>\n\t\t\t</related_crises>\n\t\t\t<related_people>\n\t\t\t\t<personRef>Rebiya_Kadeer</personRef>\n\t\t\t\t<personRef>Mustafa_Abdul_Jalil</personRef>\n\t\t\t\t<personRef>Bashar_al-Assad</personRef>\n\t\t\t\t<personRef>Mir_Hossein_Mousavi</personRef>\n\t\t\t</related_people>\n\t\t</org>\n\t\t<org id = \"World_Uyghur_Congress\">\n\t\t\t<name>World Uyghur Congress</name>\n\t\t\t<kind>international org. of exiled Uyghurs</kind>\n\t\t\t<location>80103 Munich, Germany</location>\n\t\t\t<history>\tThe World Uyghur Congress (WUC) is an international organisation that represents the collective interest of the Uyghur people both in East Turkestan and abroad.\n\nThe WUC was established on 16 April 2004 in Munich, Germany, after the East Turkestan National Congress and the World Uyghur Youth Congress merged into one united organisation. The main objective of WUC is to promote the right of the Uyghur people to use peaceful, nonviolent, and democratic means to determine the political future of East Turkestan.\n\nThe WUC is a democratic organisation. All of WUC leadership was democratically elected by the participants from all over the world in the General Assembly. They all serve a three-year term. WUC has close contacts and working relations with most Uyghur organisations in the world that peacefully promote human rights, religious freedom, and democracy for the Uyghur people in East Turkestan.\n\nOn the First General Assembly of WUC in 2004 Mr. Erkin Alptekin was elected as president. He had lead WUC to its second General Assembly in 2006. Mr. Alptekin is a former general secretary of the Unrepresented Nations and Peoples Organization (UNPO) based in The Hague, the Netherlands. He has remarkable experience in working with international organisations and governments in lobbying for the Uyghur people’s right to self-determination. He is also a close friend of the Dalai Lama, spiritual leader of the Tibetan people.\n\nOn the Second General Assembly of the WUC, which took place in Munich from 24 - 27 November 2006, all delegates elected Ms. Rebiya Kadeer as the president of WUC.\n\nThe Third General Assembly of the WUC was convened in Washington, DC from 21 - 25 May 2009. Delegates and observers from Australia, Belgium, Canada, Denmark, France, Germany, Holland, Japan, Kazakhstan, Kyrgyzstan, Norway, Sweden, Turkey and the United States attended the Assembly.\n\nThe Fouth General Assembly of the WUC was convened in Tokyo, Japan from 14 - 18 May 2012. Delegates and observers from Australia, Belgium, Canada, Denmark, France, Germany, Holland, Japan, Kazakhstan, Kyrgyzstan, Norway, Sweden, Turkey and the United States attended the Assembly. Ms. Rebiya Kadeer, the leader of the international Uyghur human rights and democracy movement, was re-elected unanimously as the president of the WUC.\n\nBefore Rebiya Kadeer was elected as the president of WUC, she founded the “Uyghur Human Rights and Democracy Foundation” and headed the Uyghur American Association (UAA) based on Washington DC. She was also the winner of Rafto Prize and the nominee for 2005-2006-2007-2008-2009-2010-2011 Nobel Peace Prize. She spent nearly six years in Chinese prisons. After her release in 2006, she has been exerting all her energy to fight for freedom, democracy and human rights for Uyghur people. For her great work she is entitled as the “Leader and the Spiritual Mother of Uyghurs”.</history>\n\t\t\t<contact_info>\n\t\t\t\t<email>contact@uyghurcongress.org</email>\n\t\t\t\t<phone_number>0049 (0) 89 5432 1999</phone_number>\n\t\t\t\t<address>80103 Munich, Germany</address>\n\t\t\t</contact_info>\n\t\t\t<images>\n\t\t\t\t<link>http://tibettruth.files.wordpress.com/2009/07/uyghur_xinjiang_flag.gif</link>\n\t\t\t</images>\n\t\t\t<videos>\n\t\t\t\t<link>http://www.youtube.com/watch?v=877rMmw-7lA&amp;feature=results_main&amp;playnext=1&amp;list=PL08BA542027862B39</link>\n\t\t\t\t<link>http://www.youtube.com/watch?v=5LNuLzqk00c</link>\n\t\t\t</videos>\n\t\t\t<social_networks>\n\t\t\t\t<link>https://twitter.com/#!/UyghurCongress</link>\n\t\t\t</social_networks>\n\t\t\t<external_links>\n\t\t\t\t<link>http://www.uyghurcongress.org/</link>\n\t\t\t\t<link>http://tibettruth.com/2009/07/07/statement-by-the-world-uyghur-congress/</link>\n\t\t\t</external_links>\n\t\t\t<related_crises>\n\t\t\t\t<crisisRef>Xinjiang_Riots</crisisRef>\n\t\t\t</related_crises>\n\t\t\t<related_people>\n\t\t\t\t<personRef>Rebiya_Kadeer</personRef>\n\t\t\t</related_people>\n\t\t</org>\n\t</orgs>\n</everything>")
    
    def test_ExportXml_5 (self) :
        data = ImportXml("WC.xml")
        result = ExportXml(data)
        self.assert_(result == "")
    
    def test_ExportXml_6 (self) :
        data = ImportXml("WC.xml")
        result = ExportXml(data)
        self.assert_(result == "")
    
    def test_fixAmp_1 (self) :
        line = ""
        result = fixAmp(line)
        self.assert_(result == "")
    
    def test_fixAmp_2 (self) :
        line = "&"
        result = fixAmp(line)
        self.assert_(result == "&amp;")
    
    def test_fixAmp_2 (self) :
        line = "&&"
        result = fixAmp(line)
        self.assert_(result == "&amp;&amp;")
        
        
